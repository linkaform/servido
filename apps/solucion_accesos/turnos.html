<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Portal De Turnos</title>
    <link rel="icon" type='image/svg+xml' href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 576 512'><path  d='M320 32c0-9.9-4.5-19.2-12.3-25.2S289.8-1.4 280.2 1l-179.9 45C79 51.3 64 70.5 64 92.5V448H32c-17.7 0-32 14.3-32 32s14.3 32 32 32H96 288h32V480 32zM256 256c0 17.7-10.7 32-24 32s-24-14.3-24-32s10.7-32 24-32s24 14.3 24 32zm96-128h96V480c0 17.7 14.3 32 32 32h64c17.7 0 32-14.3 32-32s-14.3-32-32-32H512V128c0-35.3-28.7-64-64-64H352v64z'%3E%3C/path%3E%3C/svg%3E" />

    <link rel="stylesheet" type="text/css" href="../styles/css/styles_index.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.10.5/dist/sweetalert2.min.css"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/7.29.2/sweetalert2.all.js"></script> 
 <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <link href="https://unpkg.com/tabulator-tables/dist/css/tabulator.min.css" rel="stylesheet"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="./style.css">

</head>
<body>
    <navbar-component ></navbar-component>
    <section class="mainSection">       
        <div class="row d-flex justify-content-center align-items-end m-0 p-0" >
            <div class="col-sm-6 col-md-6 col-lg-6 col-xl-4 ml-9 p-0 " >        
                <div class="card m-2  mb-0 ms-0 pl-0 " style="border:none;">
                    <div class="card-body m-0 customCard">
                        <div class="row" >
                            <div class="col-4 text-center">
                                <img src="" height="100px" width="100px" class="d-inline-block rounded-circle" alt="" id="imgProfilePic"><br>

                                <input type="file" accept="image/*" variant="danger" id="inputFileUser" class="button-img-users" style="display: none;">
                                <button type="button" class="btn btn-success btn-sm m-2 " id="buttonChangeImage" onclick="cambiarImagenGuardia()" >Cambiar Imagen
                                </button>
                            </div>
                            <div class="col-8">
                                <h5 class="card-title text-dark mb-0 " id="textName"> </h5>
                                <small class="text-black" id="textPosition" ></small><br>
                                <small class="text-black" id="textEmail" > </small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-6 col-md-6 col-lg-6 col-xl-5 mt-2 ms-4">
                <div class="d-flex justify-content-end m-0 p-0" >
                    <div class="buttonIniciarTurno m-0 p-0 mb-4">
                        <button type="button" class="btn " id="buttonChangeStatusTurn" onclick="AlertAndActionChangeStatusTurn()"> </button>
                    </div>
                </div>
                <div class="d-flex">
                    <div class="flex-grow-1"> <!--ocupa todo el espacio disponible y los demas elementos solo lo necesario-->
                        <b>Notas</b>
                    </div>
                    <div >
                        <button type="button" class="btn btn-success btn-sm mb-1 " onclick="setModal('addNota',1)" id="buttonAgregarNotas"><i class="fa-solid fa-plus"></i>
                        </button>
                        <button type="button" class="btn btn-primary btn-sm mb-1 " onclick="redirectionUrl('notas',true);"><i class="fa-solid fa-list"></i></button>
                    </div>
                </div>
                <div id="tableNotas"></div>
            </div>
            </div>
            <div class="row d-flex flex-row mt-5 justify-content-center mb-5">
                <div class="col-sm-12 col-md-12 col-lg-4 col-xl-3 m-1  customShadow h-auto"  >
                    <div class="d-flex ms-1 mt-3">
                        <div class="flex-grow-1">
                            <b>Informacion de ubicacion:</b>
                        </div>
                        <div >
                            <button type="button" class="btn btn-success btn-sm" onclick="setModal('cambiarCaseta')" id="buttonCambiarCaseta"
                            >Cambiar Caseta</button>
                            <button class="btn btn-success btn-sm" type="button" id="loadingButtonCaseta" disabled>
                                  <span class="spinner-border spinner-border-sm " role="status" aria-hidden="true"></span>
                                  Cargando...
                            </button>
                        </div>
                    </div>
                    <table class="table table-borderless mt-3 w-auto" style="border: none;">
                        <tbody>
                            <tr>
                                <td><b>Ubicacion:</b></td>
                                <td> <span id="textUbicacion"> </span></td>
                            </tr>
                            <tr>
                                <td><b>Cuidad:</b></td>
                                <td><span id="textCuidad"> </span></td>
                            </tr>
                            <tr>
                                <td><b>Estado:</b></td>
                                <td><span id="textEstado"> </span></td>
                            </tr>
                            <tr>
                                <td><b>Direccion:</b></td>
                                <td><span id="textDireccion"> </span></td>
                            </tr>
                            <tr>
                                <td><b>Caseta:</b></td>
                                <td><span id="textCaseta"> </span></td>
                            </tr>
                        </tbody>
                    </table>
                    <hr>
                    <table class="table table-borderless mt-3 w-auto" style="border: none;">
                        <tbody>
                            <tr>
                                <td><b>Estatus de la caseta: </b></td>
                                <td> <span id="textEstatusCaseta"> </span></td>
                            </tr>
                         
                            <tr>
                                <td><b> <span id="headGuardiaEnTurno"></span></b></td>
                                <td><span id="textGuardiaEnTurno"> </span></td>
                            </tr>
                               <tr>
                                <td><b><span id="headFechaInicioTurno"></span> </b> </td>
                                <td> <span id="textFechaInicioCaseta"></span></td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="d-flex justify-content-end">
                        <button type="button" class="btn btn-danger btn-sm" onclick="AlertForzarCierre(getCookie('userCasetaGuard'))" id="buttonForzarCierre">Forzar Cierre</button>
                    </div>
                </div>
                <div class="col-sm-12 col-md-12 col-lg-4 col-xl-3 m-1 " >
                    <div class="row d-flex flex-row  customShadow" >
                        <div class=" mt-3 ms-2">
                            <b>Estado del turno:</b>
                        </div>
                        <table class="table table-borderless mt-3 ms-2 w-auto" style="border: none;  height: 100px;">
                            <tbody>
                                <tr>
                                    <td><b>Fecha:</b></td>
                                    <td id="todayDateText"> </td>
                                </tr>
                                <tr>
                                    <td><b>Hora:</b></td>
                                    <td id="todayHourText"> </td>
                                </tr>
                                <tr>
                                    <td><b>Estatus:</b></td>
                                    <td id='statusTurnText'> </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="row d-flex flex-row customShadow mt-2 ">
                        <div class=" mt-3 ms-2">
                            <b> <span id= 'textInfActualCaseta'></span></b>
                        </div>
                        <table class="table table-borderless mt-3 ms-2 w-auto h-auto" style="border: none; height: 260px!important;">
                            <tbody>
                                <tr>
                                    <td><i class="fa fa-users" ></i> <b> Visitas dentro:</b></td>
                                    <td><span id="textPersonalDentro"> </span></td>
                                </tr>
                                <tr>
                                    <td><i class="fa fa-th" ></i> <b> Articulos consesionados:</b></td>
                                    <td><span id="textArticulosConsesionados"> </span></td>
                                </tr>
                                <tr>
                                    <td><i class="fa fa-question-circle" ></i> <b> Incidentes pedientes:</b></td>
                                    <td><span id="textIncidentesPendientes"> </span></td>
                                </tr>
                                <tr>
                                    <td><i class="fa fa-car" ></i> <b> Vehiculos estacionados:</b></td>
                                    <td><span id="textVehiculosEstacionados"> </span></td>
                                </tr>
                                <tr>
                                    <td><i class="fa fa-id-card" ></i> <b> Gafetes pendientes:</b></td>
                                    <td><span id="textGafetesPendientes"> </span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="col-sm-12 col-md-12 col-lg-4 col-xl-3 m-1 styleTable " >
                    <div id="tableGuardiasApoyo"></div>
                    <div class="d-flex justify-content-end align-items-end mt-4">                        
                        <button type="button" class="btn btn-success btn-sm" id="idButtonGuardiasApoyo" disabled onclick="cargarGuardiasApoyo()">Agregar guardia de apoyo</button>
                        <button class="btn btn-success btn-sm" type="button" id="idLoadingButtonGuardiasApoyo" style="display:none;" disabled>
                            <span class="spinner-border spinner-border-sm " role="status" aria-hidden="true"></span>
                            Cargando...
                        </button>
                    </div>
                </div>  
            </div>
    </section>

    <!-- Modales -->
    <div class="modal fade" id="cambiarCasetaModal" tabindex="-1"  aria-hidden="true" >
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-lg" style="width: 500px;">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5">Cambiar Caseta</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="d-flex justify-content-center mb-4">
                        <div><h5>Selecciona una caseta para continuar...</h5></div>
                    </div>
                    <div id="tableCambiarCaseta"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger btn-sm" data-bs-dismiss="modal" >Cancelar</button>
                  <!--  <button type="button" class="btn btn-success btn-sm" onclick="cambiarCaseta()">Seleccionar</button> -->
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="agregarNotasModalTurnos" tabindex="-1"  aria-hidden="true">
         <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-lg" style="width: 600px;">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5">Agregar notas</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"  aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="mb-3 col-12">
                            <label class="form-label">Nota *</label>
                              <textarea class="form-control nueva-nota" id="textAreaNuevaNotaNota" rows="3" placeholder="Escribe algo..."></textarea>
                        </div>
                        <div id="archivo-input-form-nueva">
                            <div class="d-flex mb-3 col-12 div-archivo-nueva-123" id="id-archivo-div-123">
                                <div class="flex-grow-1">
                                    <label class="form-label">Cargar un archivo </label>
                                    <input type="file" class="form-control-file archivo-div-nueva" onchange="guardarArchivos('fileInputArchivo-nueva', false);" id="fileInputArchivo-nueva">
                                </div>
                                <div>
                                    <button type="button" class="btn btn-success button-add-register" onclick="setAddArchivo('nueva');return false;">
                                        <i class="fa-solid fa-plus"></i>
                                    </button>
                                    <button type="button" class="btn btn-danger button-delete-register" onclick="setDeleteArchivo('nueva',123);return false;">
                                        <i class="fa-solid fa-minus"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div id="foto-input-form-nueva" >
                            <div class="d-flex mb-3 col-12 div-foto-nueva-123" id="id-foto-div-123">
                                <div class="flex-grow-1">
                                    <label class="form-label">Fotografia </label>
                                    <input type="file" class="form-control-file foto-div-nueva" onchange="guardarArchivos('fileInputFotografia-nueva',true);" id="fileInputFotografia-nueva">
                                </div>
                                <div>
                                    <button type="button" class="btn btn-success button-add-register" onclick="setAddFoto('nueva');return false;">
                                        <i class="fa-solid fa-plus"></i>
                                    </button>
                                    <button type="button" class="btn btn-danger button-delete-register"  onclick="setDeleteFoto('nueva',123);return false;">
                                        <i class="fa-solid fa-minus"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div id="comment-input-form-nueva">
                            <div class="d-flex mb-3 div-comment-nueva-123" id="div-comment-123">
                                <div class="flex-grow-1">
                                    <label class="form-label">Comentario </label>
                                    <textarea class="form-control comment-div-nueva" id="comentarioNuevaNota-nueva" rows="3" placeholder="Escribe algo..."></textarea>
                                </div>
                                <div>
                                    <button type="button" class="btn btn-success button-add-register" onclick="setAddComentario('nueva');return false;">
                                        <i class="fa-solid fa-plus"></i>
                                    </button>
                                    <button type="button" class="btn btn-danger button-delete-register"  onclick="setDeleteComentario('nueva',123);return false;">
                                        <i class="fa-solid fa-minus"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <small class="text-black-50 mt-3">** Campos son obligatorios</small>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger btn-sm" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-success btn-sm" id="idButtonEnviarNota" onclick="agregarNuevaNota()">Agregar</button>
                    <button class="btn btn-success btn-sm" type="button" id="idLoadingButtonEnviarNota" style="display:none;" disabled>
                          <span class="spinner-border spinner-border-sm " role="status" aria-hidden="true"></span>
                          Cargando...
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="agregarGuardiaApoyoModal" tabindex="-1"  aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-lg" style="width: 440px;">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5">Agregar guardia de apoyo</h1>
                    <button type="button" id="agregarGuardiasApoyoButton" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="d-flex justify-content-center mb-4">
                        <div><h5>Seleciona un guardia para continuar...</h5></div>
                    </div>
                    <div id="tableAgregarGuardiaApoyo"></div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger btn-sm" data-bs-dismiss="modal" >Cancelar</button>
                    <button type="button" class="btn btn-success btn-sm" id="idButtonAgregarGuardiaApoyoTurno" onclick="agregarNuevoGuardiaApoyo();">Seleccionar</button>
                    <button class="btn btn-success btn-sm" type="button" id="idLoadingButtonAgregarGuardiaApoyoTurno" style="display:none;" disabled>
                          <span class="spinner-border spinner-border-sm " role="status" aria-hidden="true"></span>
                          Cargando...
                    </button>
                </div>
            </div>
        </div>
    </div>

</body>
<!-- Jquery -->
<script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
<script type="text/javascript" src="https://unpkg.com/tabulator-tables/dist/js/tabulator.min.js"></script>

<!-- Tabulator -->

<!-- Local -->
<script type="text/javascript" src="../styles/js/chroma.min.js"></script>
<script type="text/javascript" src="../utils/servido_utils.js"></script>
<script src="./functions.js"></script>
<script type="text/javascript" src="./components/locationCard.js"></script>
<script type="text/javascript" src="./components/navbar.js"></script>
<script src="./turnosData.js"></script>
<script src="./turnos.js"></script>

<!-- Bootstrap -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
</html>



<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Plantilla de Correo Electrónico</title>
        <style>
            /* Estilos generales */
            body, table, td, a {
                font-family: 'Arial', sans-serif;
                font-size: 16px;
                color: #333333;
                line-height: 1.6;
            }
            body {
                margin: 0;
                padding: 0;
                background-color: #ffffff;
            }
            table {
                border-collapse: collapse;
                width: 100%;
            }
            img {
                border: 0;
                height: auto;
                line-height: 100%;
                outline: none;
                text-decoration: none;
            }
            .container {
                max-width: 600px;
                margin: 0 auto;
                background-color: #ffffff;
                padding: 20px;
            }
            /*.header {
                background-color: #021d49;
                color: #ffffff;
                padding: 20px;
                text-align: center;
            }*/
            .content {
                padding: 20px;
                text-align: justify;
            }
            .footer {
                background-color: #F5F5F5;
                color: #666666;
                padding: 20px;
                text-align: left;
            }
            .button {
                background-color: #021d49;
                color: #ffffff;
                padding: 10px 20px;
                text-align: center;
                text-decoration: none;
                display: inline-block;
                margin: 10px 0;
                border-radius: 5px;
            }
            .button:hover {
                background-color: #005bb5;
            }
        </style>
    </head>
    <body>
        <table class="container">
            <tr>
                <td class="header">
                    <img align="left" alt="" src="https://f001.backblazeb2.com/file/app-linkaform/public-client-126/71202/60b81349bde5588acca320e1/66cf3e294e2420113f105797.png">
                </td>
            </tr>
            <tr>
                <td class="content">
                    <h3>Hola {{record.answers.662c2937108836dec6d92580}},</h3>
                    <p>Has sido invitado a visitar a: </p>
                    {% if answers.663d4ba61b14fab90559ebb0 %}
                        {% if answers.663d4ba61b14fab90559ebb0 | length > 0 %}
                            <ul>
                                {% for item in answers.663d4ba61b14fab90559ebb0 %}
                                    {% if item.66a83ab5ca3453e21ea08d19 %}
                                        <li>{{ item.66a83ab5ca3453e21ea08d19.62c5ff407febce07043024dd }}</li>
                                    {% endif %}
                                {% endfor %}
                            </ul>
                        {% endif %}
                    {% endif %}            
                    <p><strong>Detalles de la visita:</strong></p>
                    <ul>
                        <li><strong>Ubicación: </strong>{{record.answers.66a83a74de752e12018fbc3c.663e5c57f5b8a7ce8211ed0b}}</li>
                        <li><strong>Dirección: </strong>{{record.answers.66a83a74de752e12018fbc3c.663a7e0fe48382c5b1230902}}</li>
                        <li><strong>Fecha y hora: </strong>{{record.answers.662c304fad7432d296d92582}}</li>
                    </ul>
                    <p>Se ha creado un pre-registro y ahora está pendiente de su asignación. Por favor, complete sus datos de registro en este link <a href="https://srv.linkaform.com/solucion_accesos/pase.html?id={{record.id}}&nombre={{record.answers.662c2937108836dec6d92580}}&email={{record.answers.662c2937108836dec6d92581}}&tel={{record.answers.662c2937108836dec6d92582}}&user={{record.answers.66a83ab5c3a77af505489ca2.663bd466b19b7fb7d9e97cdc}}&docs=foto-iden&emailfrom={{record.answers.66a83ab5c3a77af505489ca2.66a8470ea6665607e5663143}}" target="_blank">enlace</a>.</p>
                    <p>Saludos,<br>Equipo de Administración.</p>
                </td>
            </tr>
            <tr>
                <td class="footer">
                    <a href="https://www.linkaform.com/" target="_blank">
                        <img alt="" src="https://f001.backblazeb2.com/file/app-linkaform/public-client-126/107023/64dd1bd4fd200a3308ec2141/663517c3caae08b8adf27472.png">
                    </a>
                </td>
            </tr>
        </table>
    </body>
</html>